<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>A Letter to You - Interactive Universe</title>

<style>
* { margin: 0; padding: 0; box-sizing: border-box; }

body {
    font-family: 'Georgia', serif;
    background: radial-gradient(ellipse at center, #001a4d 0%, #000814 100%);
    color: #e8e8e8;
    min-height: 100vh;
    overflow: hidden;
}

#canvas {
    position: fixed;
    top: 0; left: 0;
    z-index: 1;
    pointer-events: none;
}

.container {
    max-width: 900px;
    margin: 60px auto;
    padding: 20px;
    position: relative;
    z-index: 10;
    perspective: 1000px;
}

.letter-wrapper {
    transform-style: preserve-3d;
    transition: transform 0.1s ease-out;
}

.letter-card {
    background: rgba(15, 23, 42, 0.95);
    border: 2px solid rgba(100, 200, 255, 0.3);
    padding: 40px;
    border-radius: 15px;
    box-shadow: 0 20px 60px rgba(0,0,0,0.8);
    min-height: 500px;
}

.letter-card h1 {
    text-align: center;
    font-size: 3.5em;
    margin-bottom: 30px;
    color: #e8d4a2;
}

.letter-content {
    font-size: 1.1em;
    line-height: 1.8;
    color: #d0d0d0;
    min-height: 300px;
}

.music-button {
    position: fixed;
    bottom: 30px;
    left: 30px;
    padding: 12px 25px;
    border-radius: 30px;
    border: none;
    background: #00bcd4;
    color: white;
    font-size: 1em;
    cursor: pointer;
    z-index: 20;
}
</style>
</head>

<body>

<canvas id="canvas"></canvas>

<div class="container">
  <div class="letter-wrapper" id="letterWrapper">
    <div class="letter-card" id="letterCard">
      <h1>A Letter to You</h1>
      <div class="letter-content" id="letterContent"></div>
    </div>
  </div>
</div>

<button class="music-button" id="musicBtn">♫ Play Music</button>

<script>
const canvas = document.getElementById('canvas');
const ctx = canvas.getContext('2d');
const letterContent = document.getElementById('letterContent');
const letterWrapper = document.getElementById('letterWrapper');
const letterCard = document.getElementById('letterCard');
const musicBtn = document.getElementById('musicBtn');

function resizeCanvas() {
  canvas.width = window.innerWidth;
  canvas.height = window.innerHeight;
}
resizeCanvas();
window.addEventListener('resize', resizeCanvas);

// ===== TEXT =====
const letterText = `Dear Friend,

I wanted to take a moment to tell you something that's been on my mind.
Like atoms dancing in the cosmic void, you bring meaning and light to my world.

There’s something beautiful about connections that don’t demand explanation.
You are one of those rare connections for me.

With warmth,
A Friend From the Universe`;

const glitterWords = [
 'sacred','dream','peace','love','wonder','magic',
 'eternal','hope','divine','cosmic','infinite',
 'grace','light','soul','pure'
];

const colors = [
 '#FFD700','#FF69B4','#87CEEB','#98FF98','#FFB347',
 '#DDA0DD','#87CEEB','#F0E68C','#FFA07A','#98FB98',
 '#87CEFA','#DDA0DD','#FFB6C1','#B0E0E6','#F0E68C'
];

// ===== PARTICLE CLASS =====
class WordParticle {
  constructor(x, y, word, color) {
    this.x = x;
    this.y = y;
    this.word = word;
    this.color = color;

    this.vx = (Math.random() - 0.5) * 2;
    this.vy = Math.random() * 2 + 1; // always falling
    this.size = 16;
  }

  update(mouseX, mouseY) {
    const GRAVITY = 0.4;
    this.vy += GRAVITY;

    // Mouse repulsion
    const dx = this.x - mouseX;
    const dy = this.y - mouseY;
    const dist = Math.sqrt(dx*dx + dy*dy);
    const maxDist = 160;

    if (dist < maxDist && dist > 0) {
      const force = (1 - dist / maxDist) * 0.5;
      this.vx += (dx / dist) * force;
      this.vy += (dy / dist) * force;
    }

    // Light damping
    this.vx *= 0.995;
    this.vy *= 0.995;

    // Move
    this.x += this.vx;
    this.y += this.vy;

    // Floor bounce
    if (this.y > canvas.height - 10) {
      this.y = canvas.height - 10;
      this.vy *= -0.55;
      this.vx *= 0.85;
    }

    // Wall bounce
    if (this.x < 0 || this.x > canvas.width) {
      this.vx *= -0.6;
    }
  }

  draw() {
    ctx.fillStyle = this.color;
    ctx.font = `bold ${this.size}px Georgia`;
    ctx.textAlign = 'center';
    ctx.textBaseline = 'middle';
    ctx.fillText(this.word, this.x, this.y);
  }
}

const particles = [];

// ===== TYPEWRITER =====
let charIndex = 0;

function typeWriter() {
  if (charIndex < letterText.length) {
    const char = letterText[charIndex];
    letterContent.innerHTML += (char === '\n') ? '<br>' : char;
    charIndex++;

    if (charIndex % 20 === 0 && particles.length < 50) {
      createGravityWord();
    }

    setTimeout(typeWriter, 40);
  }
}

// ===== SPAWN WORD =====
function createGravityWord() {
  const word = glitterWords[Math.floor(Math.random() * glitterWords.length)];
  const color = colors[glitterWords.indexOf(word)];
  const x = Math.random() * canvas.width;
  const y = -20 - Math.random() * 120; // spawn above screen
  particles.push(new WordParticle(x, y, word, color));
}

// ===== MOUSE + TILT =====
let mouseX = canvas.width / 2;
let mouseY = canvas.height / 2;

document.addEventListener('mousemove', e => {
  mouseX = e.clientX;
  mouseY = e.clientY;

  const rect = letterCard.getBoundingClientRect();
  const cx = rect.left + rect.width / 2;
  const cy = rect.top + rect.height / 2;

  const rx = (e.clientY - cy) * 0.02;
  const ry = (e.clientX - cx) * -0.02;

  letterWrapper.style.transform = `rotateX(${rx}deg) rotateY(${ry}deg)`;
});

// ===== ANIMATION LOOP =====
function animate() {
  ctx.clearRect(0, 0, canvas.width, canvas.height);

  particles.forEach(p => {
    p.update(mouseX, mouseY);
    p.draw();
  });

  requestAnimationFrame(animate);
}
animate();

// ===== MUSIC =====
const bgMusic = new Audio();
bgMusic.loop = true;
bgMusic.volume = 0.3;

musicBtn.addEventListener('click', () => {
  if (bgMusic.paused) {
    bgMusic.play();
    musicBtn.textContent = '⏸ Pause Music';
  } else {
    bgMusic.pause();
    musicBtn.textContent = '♫ Play Music';
  }
});

// ===== START =====
window.addEventListener('load', () => {
  setTimeout(typeWriter, 500);
  for (let i = 0; i < 10; i++) {
    setTimeout(createGravityWord, i * 250);
  }
});
</script>

</body>
</html>
